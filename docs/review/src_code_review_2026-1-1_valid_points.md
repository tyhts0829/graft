# src_code_review_2026-1-1 から抽出した妥当な指摘（要約）

- 対象: `docs/review/src_code_review_2026-1-1.md`
- 作成日: 2026-01-01

## ドキュメント/構造

- README や開発者向けガイドに、パッケージ責務の「モジュールマップ」を短く載せる（初見の導線）。
- ドキュメント上の「機能の実装状況」とコードの同期を保つ（例: export / PNG / MP4 / G-code）。

## ParamStore / パラメータ解決

- パラメータの「観測（record）」と「適用（resolve/override）」が API 層・pipeline・context にまたがるため、仕様変更時の修正漏れリスクがある。
- データフロー（ユーザ指定→defaults→記録→GUI override→次フレーム反映）を 1 箇所で追える資料（ガイド/図）を用意する。
- 各段階の整合性を担保するテスト（最低でもユニット/小さめの統合）を用意する。

## core.pipeline の責務境界

- `core.pipeline.realize_scene()` 内で ParamStore の GUI override を適用している点は、境界侵食として意識しておく。
- 将来「export は GUI の一時値を無視したい」などの要件が出る可能性があるため、必要になったら override 適用を切り替える仕組み（フラグ/別関数/外だし）を検討する。

## MpDraw（マルチプロセス）

- mp-draw は有用だが、IPC/例外/スナップショット同期などで複雑になり、並列時のみ起きる不具合のデバッグが難しい。
- 開発中に切り替えやすい「強制シングルプロセス」スイッチ（API/環境変数/デバッグ UI など）や、mp 経路のテストを用意する。

## Parameter GUI

- UI コードは構造化されているが、ParamStore との双方向同期が散在しやすく、将来の機能追加で修正漏れが起きやすい。
- 無理に抽象化し過ぎず、意図を伝えるコメント/docstring を維持しつつ、必要に応じて “Param → 標準 UI” の薄い層を検討する。

## 運用（型/ログ）

- 型ヒント・静的解析（ruff/mypy）を段階的に整備し、将来のリファクタの安全網にする。
- 重要な状態遷移（保存通知、ロード/セーブ、ワーカー開始/終了、録画開始/停止など）をログとして残し、デバッグ容易性を上げる。
